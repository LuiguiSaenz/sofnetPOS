(this["webpackJsonpreact-basic-authentication-example"]=this["webpackJsonpreact-basic-authentication-example"]||[]).push([[0],{29:function(e,t,a){e.exports=a(43)},43:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(16),l=a(6),c=a(7),s=a(10),i=a(9),m=a(11),u=a(5),p=a(28),h=function(e){var t=e.component,a=Object(p.a)(e,["component"]);return n.a.createElement(u.d,Object.assign({},a,{render:function(e){return localStorage.getItem("user")?n.a.createElement(t,e):n.a.createElement(u.c,{to:{pathname:"/login",state:{from:e.location}}})}}))},d=a(13),A=a(8),E=a(27),f=a.n(E),g=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}),b=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"mostrarCarrito",value:function(){return 0===this.props.carrito.length?n.a.createElement("h4",null,"Sin productos en carrito"):this.props.carrito.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,n.a.createElement("p",{id:t},"1 ",e.nombre,"  ")),n.a.createElement("td",{className:"tdright"},n.a.createElement("p",null,g.format(e.precio)," ")))}))}},{key:"render",value:function(){var e=this.props.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),t=e-e*parseInt(this.props.descuento)/100,a=e*this.props.descuento/100,r=this.props.tiempo;return n.a.createElement("div",null,n.a.createElement("div",{className:"encabezadoboleta"},n.a.createElement("h4",null,this.props.datosempresa.razon," "),n.a.createElement("p",null,this.props.datosempresa.direccion," "),n.a.createElement("p",null,n.a.createElement("b",null,"RUT:")," ",this.props.datosempresa.rut_empresa," "),n.a.createElement("p",null,n.a.createElement("b",null,"GIRO:")," ",this.props.datosempresa.giro1," "),n.a.createElement("p",null,n.a.createElement("b",null,"FECHA:")," ",r," ")),n.a.createElement("h4",null,"COMPROBANTE DE VENTA"),n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("th",null,"PRODUCTO"),n.a.createElement("th",{className:"tdright"},"PRECIO UNIDAD")),n.a.createElement("tbody",{style:{borderTop:"1px solid black"}},this.mostrarCarrito(),n.a.createElement("tr",{style:{borderTop:"1px solid black"}},n.a.createElement("td",null,n.a.createElement("p",null,"SUBTOTAL")),n.a.createElement("td",{className:"tdright"},g.format(e)," ")),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("p",null,"DESCUENTO")),n.a.createElement("td",{className:"tdright"},g.format(a)," ")),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("p",null,"TOTAL")),n.a.createElement("td",{className:"tdright"},g.format(t))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("p",null,"TIPO DE PAGO")),n.a.createElement("td",{className:"tdright"},n.a.createElement("p",{className:"uppercase"},this.props.tipopago," "))))))}}]),t}(n.a.Component),v=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e){a.setState({filter:e.target.value})},a.handleTipoPago=function(e){var t=e.target.value;a.setState({tipopago:t})},a.handleVuelto=function(e){var t=0;""!==e.target.value&&(t=e.target.value),a.setState({efectivo:t})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),r=t-t*parseInt(a.state.descuento)/100,n=a.state.carrito;n.forEach((function(e){return e.Descuento="0"})),n.forEach((function(e){return e.Cantidad="1"})),n.forEach((function(e){return e.Bodega="1989"})),n.forEach((function(e){return e.Afecto=!1}));var o=[{Encabezado:{Receptor:"66666666-6",MontoNeto:r,Descuento:a.state.descuento,TipoDocumento:"39",AreaNegocio:"3609",Observacion:"observacion",Direccion:"123"},Detalle:n,Adicional:{Uno:"4131",Dos:"11111111-1",Treinta:"123"}}];console.log(o);var l=a.state.token.token;console.log(l),fetch("http://api.softnet.cl/boleta",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",token:l},body:JSON.stringify({enviarBoleta:o})}).then((function(e){return e.json()})).then((function(e){console.log(e),a.inputElement.click(),a.setState({carrito:[]}),localStorage.setItem("carrito",JSON.stringify(a.state.carrito))})).catch((function(e){a.state.cola.push(o),a.setState({cola:a.state.cola}),localStorage.setItem("cola",JSON.stringify(a.state.cola)),a.inputElement.click(),a.setState({carrito:[]}),localStorage.setItem("carrito",JSON.stringify(a.state.carrito))}))},a.handleDescuento=function(e){var t=0;t=""===e.target.value?0:e.target.value,a.setState({descuento:t})},a.state={productos:[],carrito:JSON.parse(localStorage.getItem("carrito")),filter:"",descuento:0,montofinal:0,cola:JSON.parse(localStorage.getItem("cola")),efectivo:0,tipopago:"efectivo",datosempresa:"",curtime:(new Date).toLocaleString(),token:JSON.parse(localStorage.getItem("user"))},a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getDatosEmpresa",value:function(e){var t=this;return fetch("http://apitest.softnet.cl/datoEmpresa",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("business",JSON.stringify(e[0])),t.setState({datosempresa:e[0]})})).catch((function(e){console.log(e)}))}},{key:"getProductos",value:function(e){var t=this;return this.setState({loading:!0}),fetch("http://api.softnet.cl/productos",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){console.log(e),localStorage.setItem("productos",JSON.stringify(e)),t.setState({productos:e,loading:!1})})).catch((function(e){console.log(e)}))}},{key:"agregarCarrito",value:function(e){this.state.carrito.push(e),this.setState({carrito:this.state.carrito}),localStorage.setItem("carrito",JSON.stringify(this.state.carrito))}},{key:"mostrarCarrito",value:function(){var e=this;return 0===this.state.carrito.length?n.a.createElement("h4",null,"Sin productos en carrito"):n.a.createElement("div",{className:"carrito"},this.state.carrito.map((function(t,a){return n.a.createElement("div",{key:a,className:"productos-unitario"},n.a.createElement("a",{onClick:function(){return e.removerDelCarrito(a)},href:"javascript:void(0)"},n.a.createElement("i",{className:"fas fa-minus-circle"}))," ",n.a.createElement("p",{id:a},"1 ",t.nombre,"  "),n.a.createElement("b",null,g.format(t.precio)," "))})))}},{key:"removerDelCarrito",value:function(e){var t=this.state.carrito;t.splice(e,1);this.setState({carrito:t}),localStorage.setItem("carrito",JSON.stringify(t))}},{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));this.getProductos(t.token),this.getDatosEmpresa(t.token),setInterval((function(){e.setState({curtime:(new Date).toLocaleString()})}),1e3)}},{key:"render",value:function(){var e=this,t=this.state,a=t.filter,r=t.productos,o=a.toLowerCase(),l=r.filter((function(e){return Object.keys(e).some((function(t){return e[t].toString().toLowerCase().includes(o)}))})),c=this.state.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),s=c-c*parseInt(this.state.descuento)/100,i=parseInt(this.state.efectivo)-s;return n.a.createElement("div",{className:"row"},n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement("div",{className:"col-md-6 col-md-6"},n.a.createElement("h2",{className:"titulocart"},"CARRITO"),n.a.createElement(u.b,{style:{float:"right",marginTop:-35},to:"/login"},"Salir"),n.a.createElement("h4",{className:"contadorcart"},this.state.carrito.length," Productos"),n.a.createElement("p",{className:"clear"}),this.mostrarCarrito()),n.a.createElement("div",{className:"col-md-6 col-md-6"},n.a.createElement("h2",null,"PRODUCTOS ",JSON.stringify(this.state.prueba)," "),n.a.createElement("input",{placeholder:"BUSCAR PRODUCTOS",className:"form-control",value:a,onChange:this.handleChange}),n.a.createElement("div",{className:"contenedor-productos"},l.map((function(t,a){return n.a.createElement("div",Object(d.a)({className:"boxproducto",key:a,onClick:function(){return e.agregarCarrito(t)}},"key",a),n.a.createElement("h4",{className:"left"}," ",t.nombre," "),n.a.createElement("p",{className:"hide"},t.codigo," ")," ",n.a.createElement("h4",{className:"right"},g.format(t.precio)," "))}))),n.a.createElement("h3",null,"TOTAL: ",g.format(s)),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{className:"form-label"},"TIPO DE PAGO"),n.a.createElement("select",{className:"form-control",onChange:this.handleTipoPago},n.a.createElement("option",{value:"efectivo"},"EFECTIVO"),n.a.createElement("option",{value:"debito"},"DEBITO"),n.a.createElement("option",{value:"credito"},"CR\xc9DITO"))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{className:"form-label"},"TIPO DE DOCUMENTO"),n.a.createElement("select",{className:"form-control"},n.a.createElement("option",{value:"BOLETA SIMPLE"},"BOLETA SIMPLE"),n.a.createElement("option",{value:"BOLETA DETALLE"},"BOLETA DETALLE"),n.a.createElement("option",{value:"FACTURA"},"FACTURA"))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{className:"form-label"},"DESCUENTO - Porcentaje"),n.a.createElement("input",{placeholder:"DESCUENTO",className:"form-control",onChange:this.handleDescuento})),n.a.createElement("div",{className:"col-medium"},n.a.createElement("label",{className:"form-label"},"Monto a pagar"),n.a.createElement("input",{placeholder:"MONTO",className:"form-control",onChange:this.handleVuelto})),n.a.createElement("div",{className:"col-medium"},n.a.createElement("label",{className:"form-label"},"Vuelto"),n.a.createElement("input",{placeholder:"VUELTO",className:"form-control",value:g.format(i)})),n.a.createElement("input",{className:"btn btn-sucess",type:"submit",value:"FINALIZAR Y PAGAR"}))),n.a.createElement(f.a,{trigger:function(){return n.a.createElement("a",{ref:function(t){return e.inputElement=t},className:"hide",href:"javascript:void(0)"},"IMPRIMIR")},content:function(){return e.componentRef}}),n.a.createElement(b,{tiempo:this.state.curtime,datosempresa:this.state.datosempresa,tipopago:this.state.tipopago,descuento:this.state.descuento,carrito:this.state.carrito,ref:function(t){return e.componentRef=t}}))}}]),t}(n.a.Component),O={login:function(e,t,a){var r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify({username:e,password:t,rut:a})};return fetch("http://api.softnet.cl/login",r).then((function(e){return e.json()})).then((function(a){return a.token&&(a.authdata=window.btoa(e+":"+t),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("carrito",JSON.stringify([])),localStorage.setItem("cola",JSON.stringify([]))),a}))},logout:function(){localStorage.removeItem("user"),localStorage.removeItem("carrito"),localStorage.removeItem("productos")}};var N=function(e){function t(e){var a;return Object(l.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e)),O.logout(),a.state={username:"",password:"",rut:"",submitted:!1,loading:!1,error:""},a.handleChange=a.handleChange.bind(Object(A.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,r=t.value;this.setState(Object(d.a)({},a,r))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({submitted:!0});var a=this.state,r=a.username,n=a.password,o=a.rut;r&&n&&o&&(this.setState({loading:!0}),O.login(r,n,o).then((function(e){var a=(t.props.location.state||{from:{pathname:"/"}}).from;t.props.history.push(a)}),(function(e){return t.setState({error:e,loading:!1})})))}},{key:"render",value:function(){var e=this.state,t=e.username,a=e.password,r=e.rut,o=e.submitted,l=e.loading,c=e.error;return n.a.createElement("div",{className:"col-md-6 col-md-offset-3"},n.a.createElement("h2",null,"Iniciar Sesi\xf3n"),n.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},n.a.createElement("div",{className:"form-group"+(o&&!t?" has-error":"")},n.a.createElement("label",{htmlFor:"username"},"Usuario"),n.a.createElement("input",{type:"text",className:"form-control",name:"username",value:t,onChange:this.handleChange}),o&&!t&&n.a.createElement("div",{className:"help-block"},"Username is required")),n.a.createElement("div",{className:"form-group"+(o&&!r?" has-error":"")},n.a.createElement("label",{htmlFor:"rut"},"RUT"),n.a.createElement("input",{type:"text",className:"form-control",name:"rut",value:r,onChange:this.handleChange}),o&&!r&&n.a.createElement("div",{className:"help-block"},"rut is required")),n.a.createElement("div",{className:"form-group"+(o&&!a?" has-error":"")},n.a.createElement("label",{htmlFor:"password"},"Contrase\xf1a"),n.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a,onChange:this.handleChange}),o&&!a&&n.a.createElement("div",{className:"help-block"},"Password is required")),n.a.createElement("div",{className:"form-group"},n.a.createElement("button",{className:"btn btn-primary",disabled:l},"ENTRAR"),l&&n.a.createElement("img",{alt:"a",src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="})),c&&n.a.createElement("div",{className:"alert alert-danger"},c)))}}]),t}(n.a.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"jumbotron"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"col-sm-12"},n.a.createElement(u.a,null,n.a.createElement("div",null,n.a.createElement(h,{exact:!0,path:"/",component:v}),n.a.createElement(u.d,{path:"/login",component:N}))))))}}]),t}(n.a.Component);Object(o.render)(n.a.createElement(S,null),document.getElementById("app"))}},[[29,1,2]]]);
//# sourceMappingURL=main.cf8decfd.chunk.js.map