(this["webpackJsonpreact-basic-authentication-example"]=this["webpackJsonpreact-basic-authentication-example"]||[]).push([[0],{29:function(e,t,a){e.exports=a(43)},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(16),c=a(6),l=a(7),s=a(10),i=a(9),m=a(11),u=a(5),d=a(28),p=function(e){var t=e.component,a=Object(d.a)(e,["component"]);return r.a.createElement(u.d,Object.assign({},a,{render:function(e){return localStorage.getItem("user")?r.a.createElement(t,e):r.a.createElement(u.c,{to:{pathname:"/login",state:{from:e.location}}})}}))},h=a(13),A=a(8),g=a(27),E=a.n(g),f=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}),v=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"mostrarCarrito",value:function(){return 0===this.props.carrito.length?r.a.createElement("h4",null,"Sin productos en carrito"):this.props.carrito.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,r.a.createElement("p",{id:t},"1 ",e.nombre,"  ")),r.a.createElement("td",{className:"tdright"},r.a.createElement("p",null,f.format(e.precio)," ")))}))}},{key:"render",value:function(){var e=this.props.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),t=e-e*parseInt(this.props.descuento)/100,a=e*this.props.descuento/100,n=this.props.tiempo;return r.a.createElement("div",null,r.a.createElement("div",{className:"encabezadoboleta"},r.a.createElement("h4",null,this.props.datosempresa.razon," "),r.a.createElement("p",null,this.props.datosempresa.direccion," "),r.a.createElement("p",null,r.a.createElement("b",null,"RUT:")," ",this.props.datosempresa.rut_empresa," "),r.a.createElement("p",null,r.a.createElement("b",null,"GIRO:")," ",this.props.datosempresa.giro1," "),r.a.createElement("p",null,r.a.createElement("b",null,"FECHA:")," ",n," ")),r.a.createElement("h4",null,"COMPROBANTE DE VENTA"),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("th",null,"PRODUCTO"),r.a.createElement("th",{className:"tdright"},"PRECIO UNIDAD")),r.a.createElement("tbody",{style:{borderTop:"1px solid black"}},this.mostrarCarrito(),r.a.createElement("tr",{style:{borderTop:"1px solid black"}},r.a.createElement("td",null,r.a.createElement("p",null,"SUBTOTAL")),r.a.createElement("td",{className:"tdright"},f.format(e)," ")),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("p",null,"DESCUENTO")),r.a.createElement("td",{className:"tdright"},f.format(a)," ")),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("p",null,"TOTAL")),r.a.createElement("td",{className:"tdright"},f.format(t))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("p",null,"TIPO DE PAGO")),r.a.createElement("td",{className:"tdright"},r.a.createElement("p",{className:"uppercase"},this.props.tipopago," "))))))}}]),t}(r.a.Component),b=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleChange=function(e){a.setState({filter:e.target.value})},a.handleBodega=function(e){a.setState({inputBodega:e.target.value})},a.handleVendedor=function(e){a.setState({inputVendedor:e.target.value})},a.handleTipoPago=function(e){a.setState({inputPago:e.target.value})},a.handleAreaNegocio=function(e){a.setState({inputAreaNegocio:e.target.value})},a.handleVuelto=function(e){var t=0;""!==e.target.value&&(t=e.target.value),a.setState({efectivo:t})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),n=t-t*parseInt(a.state.descuento)/100,r=a.state.carrito;r.forEach((function(e){return e.Descuento="0"})),r.forEach((function(e){return e.Cantidad="1"})),r.forEach((function(e){return e.Bodega=a.state.inputBodega})),r.forEach((function(e){return e.Afecto=!1})),r.forEach((function(e){return e.Codigo=e.codigo}));var o=[{Encabezado:{Receptor:"66666666-6",MontoNeto:n,Descuento:a.state.descuento,TipoDocumento:"39",AreaNegocio:a.state.inputAreaNegocio,Observacion:"observacion",Direccion:"123"},Detalle:r,Adicional:{Uno:a.state.inputPago,Dos:a.state.inputVendedor,Treinta:"123"}}],c=a.state.token.token;fetch("http://localhost:8000/boleta",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",token:c},body:JSON.stringify({enviarBoleta:o})}).then((function(e){return e.json()})).then((function(e){a.inputElement.click(),a.setState({carrito:[]}),localStorage.setItem("carrito",JSON.stringify(a.state.carrito))})).catch((function(e){a.state.cola.push(o),a.setState({cola:a.state.cola}),localStorage.setItem("cola",JSON.stringify(a.state.cola)),a.inputElement.click(),a.setState({carrito:[]}),localStorage.setItem("carrito",JSON.stringify(a.state.carrito))}))},a.handleDescuento=function(e){var t=0;t=""===e.target.value?0:e.target.value,a.setState({descuento:t})},a.state={productos:[],carrito:JSON.parse(localStorage.getItem("carrito")),filter:"",descuento:0,montofinal:0,cola:JSON.parse(localStorage.getItem("cola")),efectivo:0,tipopago:"Cargando",datosempresa:"",curtime:(new Date).toLocaleString(),token:JSON.parse(localStorage.getItem("user")),bodega:[{id:0,nombre:"Cargando"}],formapago:[{id:0,nombre:"Cargando"}],vendedores:[{id:0,nombre:"Cargando"}],inputPago:"",inputBodega:"",inputVendedor:"",inputAreaNegocio:"",areaNegocio:[{id:0,nombre:"Cargando"}],loading:!0},a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"getDatosEmpresa",value:function(e){var t=this;return fetch("http://apitest.softnet.cl/datoEmpresa",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("business",JSON.stringify(e[0])),t.setState({datosempresa:e[0]})})).catch((function(e){console.log(e)}))}},{key:"getProductos",value:function(e){var t=this;return fetch("http://localhost:8000/producto",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){console.log(e),localStorage.setItem("productos",JSON.stringify(e)),t.setState({productos:e,loading:!1})})).catch((function(e){console.log(e)}))}},{key:"getBodega",value:function(e){var t=this;return fetch("http://localhost:8000/bodega",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){t.setState({bodega:e,inputBodega:e[0].id})})).catch((function(e){console.log(e)}))}},{key:"getTipoPago",value:function(e){var t=this;return fetch("http://localhost:8000/formaPago",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){t.setState({formapago:e,inputPago:e[0].id})})).catch((function(e){console.log(e)}))}},{key:"getVendedores",value:function(e){var t=this;return fetch("http://localhost:8000/vendedores",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){t.setState({vendedores:e,inputVendedor:e[0].rut_vendedor})})).catch((function(e){console.log(e)}))}},{key:"getAreaNegocio",value:function(e){var t=this;return fetch("http://localhost:8000/areaNegocio",{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",token:e}}).then((function(e){return e.json()})).then((function(e){t.setState({areaNegocio:e,inputAreaNegocio:e[0].id})})).catch((function(e){console.log(e)}))}},{key:"agregarCarrito",value:function(e){this.state.carrito.push(e),this.setState({carrito:this.state.carrito}),localStorage.setItem("carrito",JSON.stringify(this.state.carrito))}},{key:"mostrarCarrito",value:function(){var e=this;return 0===this.state.carrito.length?r.a.createElement("h4",null,"Sin productos en carrito"):r.a.createElement("div",{className:"carrito"},this.state.carrito.map((function(t,a){return r.a.createElement("div",{key:a,className:"productos-unitario"},r.a.createElement("a",{onClick:function(){return e.removerDelCarrito(a)},href:"javascript:void(0)"},r.a.createElement("i",{className:"fas fa-minus-circle"}))," ",r.a.createElement("p",{id:a},"1 ",t.nombre,"  "),r.a.createElement("b",null,f.format(t.precio)," "))})))}},{key:"removerDelCarrito",value:function(e){var t=this.state.carrito;t.splice(e,1);this.setState({carrito:t}),localStorage.setItem("carrito",JSON.stringify(t))}},{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).token;this.getProductos(t),this.getDatosEmpresa(t),this.getTipoPago(t),this.getBodega(t),this.getVendedores(t),setInterval((function(){e.setState({curtime:(new Date).toLocaleString()})}),1e3)}},{key:"render",value:function(){var e=this,t=this.state,a=t.filter,n=t.productos,o=a.toLowerCase(),c=n.filter((function(e){return Object.keys(e).some((function(t){return e[t].toString().toLowerCase().includes(o)}))})),l=this.state.carrito.reduce((function(e,t){return e+parseInt(t.precio)}),0),s=l-l*parseInt(this.state.descuento)/100,i=parseInt(this.state.efectivo)-s;return r.a.createElement((function(){return e.state.loading?r.a.createElement("h1",{className:"cargando"},"CARGANDO..."):r.a.createElement("div",{className:"row"},r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("h2",{className:"titulocart"},"CARRITO"),r.a.createElement(u.b,{style:{float:"right",marginTop:-35},to:"/login"},"Salir"),r.a.createElement("h4",{className:"contadorcart"},e.state.carrito.length," Productos"),r.a.createElement("p",{className:"clear"}),e.mostrarCarrito()),r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("h2",null,"PRODUCTOS ",JSON.stringify(e.state.prueba)," "),r.a.createElement("input",{placeholder:"BUSCAR PRODUCTOS",className:"form-control",value:a,onChange:e.handleChange}),r.a.createElement("div",{className:"contenedor-productos"},c.map((function(t,a){return r.a.createElement("div",Object(h.a)({className:"boxproducto",key:a,onClick:function(){return e.agregarCarrito(t)}},"key",a),r.a.createElement("h4",{className:"left"}," ",t.nombre," "),r.a.createElement("p",{className:"hide"},t.codigo," ")," ",r.a.createElement("h4",{className:"right"},f.format(t.precio)," "))}))),r.a.createElement("h3",null,"TOTAL: ",f.format(s)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"TIPO DE PAGO"),r.a.createElement("select",{className:"form-control",onChange:e.handleTipoPago},e.state.formapago.map((function(e){return r.a.createElement("option",{value:e.id},e.nombre)}))))),r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"BODEGA"),r.a.createElement("select",{className:"form-control",onChange:e.handleBodega},e.state.bodega.map((function(e){return r.a.createElement("option",{value:e.id},e.nombre)}))))),r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"VENDEDOR"),r.a.createElement("select",{className:"form-control",onChange:e.handleVendedor},e.state.vendedores.map((function(e){return r.a.createElement("option",{value:e.rut_vendedor},e.nombre)}))))),r.a.createElement("div",{className:"col-md-6 col-md-6"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"Area Negocio"),r.a.createElement("select",{className:"form-control",onChange:e.handleAreaNegocio},e.state.areaNegocio.map((function(e){return r.a.createElement("option",{value:e.id},e.nombre)})))))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"TIPO DE DOCUMENTO"),r.a.createElement("select",{className:"form-control"},r.a.createElement("option",{value:"BOLETA SIMPLE"},"BOLETA SIMPLE"),r.a.createElement("option",{value:"BOLETA DETALLE"},"BOLETA DETALLE"),r.a.createElement("option",{value:"FACTURA"},"FACTURA"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"form-label"},"DESCUENTO - Porcentaje"),r.a.createElement("input",{placeholder:"DESCUENTO",className:"form-control",onChange:e.handleDescuento})),r.a.createElement("div",{className:"col-medium"},r.a.createElement("label",{className:"form-label"},"Monto a pagar"),r.a.createElement("input",{placeholder:"MONTO",className:"form-control",onChange:e.handleVuelto})),r.a.createElement("div",{className:"col-medium"},r.a.createElement("label",{className:"form-label"},"Vuelto"),r.a.createElement("input",{placeholder:"VUELTO",className:"form-control",value:f.format(i)})),r.a.createElement("input",{className:"btn btn-sucess",type:"submit",value:"FINALIZAR Y PAGAR"}))),r.a.createElement(E.a,{trigger:function(){return r.a.createElement("a",{ref:function(t){return e.inputElement=t},className:"hide",href:"javascript:void(0)"},"IMPRIMIR")},content:function(){return e.componentRef}}),r.a.createElement(v,{tiempo:e.state.curtime,datosempresa:e.state.datosempresa,tipopago:e.state.inputPago,descuento:e.state.descuento,carrito:e.state.carrito,ref:function(t){return e.componentRef=t}}))}),null)}}]),t}(r.a.Component),N={login:function(e,t,a){var n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify({username:e,password:t,rut:a})};return fetch("http://api.softnet.cl/login",n).then((function(e){return e.json()})).then((function(a){return!!a.token&&(a.authdata=window.btoa(e+":"+t),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("carrito",JSON.stringify([])),localStorage.setItem("cola",JSON.stringify([])),a)}))},logout:function(){localStorage.removeItem("user"),localStorage.removeItem("carrito"),localStorage.removeItem("productos")}};var S=function(e){function t(e){var a;return Object(c.a)(this,t),a=Object(s.a)(this,Object(i.a)(t).call(this,e)),N.logout(),a.state={username:"",password:"",rut:"",submitted:!1,loading:!1,error:""},a.handleChange=a.handleChange.bind(Object(A.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(h.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({submitted:!0});var a=this.state,n=a.username,r=a.password,o=a.rut;n&&r&&o&&(this.setState({loading:!0}),N.login(n,r,o).then((function(e){var a=(t.props.location.state||{from:{pathname:"/"}}).from;t.props.history.push(a)}),(function(e){return t.setState({error:e,loading:!1})})))}},{key:"render",value:function(){var e=this.state,t=e.username,a=e.password,n=e.rut,o=e.submitted,c=e.loading,l=e.error;return r.a.createElement("div",{className:"col-md-6 col-md-offset-3"},r.a.createElement("h2",null,"Iniciar Sesi\xf3n"),r.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"+(o&&!t?" has-error":"")},r.a.createElement("label",{htmlFor:"username"},"Usuario"),r.a.createElement("input",{type:"text",className:"form-control",name:"username",value:t,onChange:this.handleChange}),o&&!t&&r.a.createElement("div",{className:"help-block"},"Username is required")),r.a.createElement("div",{className:"form-group"+(o&&!n?" has-error":"")},r.a.createElement("label",{htmlFor:"rut"},"RUT"),r.a.createElement("input",{type:"text",className:"form-control",name:"rut",value:n,onChange:this.handleChange}),o&&!n&&r.a.createElement("div",{className:"help-block"},"rut is required")),r.a.createElement("div",{className:"form-group"+(o&&!a?" has-error":"")},r.a.createElement("label",{htmlFor:"password"},"Contrase\xf1a"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a,onChange:this.handleChange}),o&&!a&&r.a.createElement("div",{className:"help-block"},"Password is required")),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",disabled:c},"ENTRAR"),c&&r.a.createElement("img",{alt:"a",src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="})),l&&r.a.createElement("div",{className:"alert alert-danger"},l)))}}]),t}(r.a.Component),C=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(p,{exact:!0,path:"/",component:b}),r.a.createElement(u.d,{path:"/login",component:S}))))))}}]),t}(r.a.Component);Object(o.render)(r.a.createElement(C,null),document.getElementById("app"))}},[[29,1,2]]]);
//# sourceMappingURL=main.1813b084.chunk.js.map